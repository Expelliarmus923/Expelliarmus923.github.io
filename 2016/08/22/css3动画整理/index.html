<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> css3动画整理 · lulizhou-blog</title><meta name="description" content="css3动画整理 - lulizhou"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVES</a></li><li class="nav-list-item"><a href="https://twitter.com/lizhou_lu" target="_blank" class="nav-list-link">TWITTER</a></li><li class="nav-list-item"><a href="https://github.com/Expelliarmus923" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">css3动画整理</h1><div class="post-meta"><div class="post-time">Aug 22, 2016</div></div><div class="post-content"><p>本文会分两部分介绍css3动画，第一部分是中规中矩的api整理，第二部分会讲讲一些实战。。</p>
<h2 id="animation"><a href="#animation" class="headerlink" title="animation"></a>animation</h2><p>通过强大的css3 animation可以取代大量JS代码，也能页面更加流畅。</p>
<p><strong> (1) animation-name </strong></p>
<p>定义动画名字（即keyframes的名字)</p>
<p><strong> (2) @keyframes </strong></p>
<p>如定义了animation-name:move;则需要定义</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@keyframes move &#123;</span><br><span class="line">  0%&#123;</span><br><span class="line">    //props</span><br><span class="line">  &#125;</span><br><span class="line">  100%&#123;</span><br><span class="line">    //props</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>或者等同于0~100%的from to</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@keyframes move &#123;</span><br><span class="line">  from &#123;</span><br><span class="line">    //props</span><br><span class="line">  &#125;</span><br><span class="line">  to &#123;</span><br><span class="line">    //props</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong> (3) animation-duration </strong></p>
<p>动画执行的时间（单位是秒，如1s）</p>
<p><strong> (4) animation-time-function </strong></p>
<p>动画播放速度曲线,这是控制运动方式的关键，默认是ease(缓解效果)。常见还有ease-in，ease-out，以及ease-in-out和linear，以及强大的立方贝塞尔曲线效果cubic-bezier。这里列举一个不常见但却十分有用的steps。</p>
<blockquote>
<p>steps(<number>[, [ start | end ] ]?)：第一个参数number为指定的间隔数，即把动画分为n步阶段性展示，第二个参数默认为end，设置最后一步的状态，start为结束时的状态，end为开始时的状态，若设置与animation-fill-mode的效果冲突，而以animation-fill-mode的设置为动画结束的状态。</number></p>
</blockquote>
<p>这个效果可以做不需要过渡效果帧动画。</p>
<a id="more"></a>
<p><strong> (5) animation-delay </strong></p>
<p>指定对象动画延迟执行的时间(单位是秒)</p>
<p><strong> (6) animation-iteration-count </strong></p>
<p>指定对象动画循环播放的次数。infinite表示无限次</p>
<p><strong> (7) animation-direction </strong></p>
<blockquote>
<p><strong> normal</strong>：正常方向。<br><br><strong> reverse</strong>：动画反向运行,方向始终与normal相反。（FF14.0.1以下不支持）<br><br><strong> alternate</strong> ：动画会循环正反方向交替运动，奇数次（1、3、5……）会正常运动，偶数次（2、4、6……）会反向运动，即所有相关联的值都会反向。<br><br><strong> alternate-reverse</strong>：动画从反向开始，再正反方向交替运动，运动方向始终与alternate定义的相反。（FF14.0.1以下不支持）<br></p>
</blockquote>
<p>这是一个十分有用的属性，比如我们需要把某个div移动到translate3d(200px,200px,0)并且改变背景色,在normal的时候我们需要</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="at_rule">@<span class="keyword">keyframes</span> move</span>&#123;</span><br><span class="line">    0%<span class="rules">&#123;</span><br><span class="line">      <span class="rule"><span class="attribute">background</span>:<span class="value"> <span class="hexcolor">#32beec</span></span></span>;</span><br><span class="line">    &#125;</span></span><br><span class="line">    25%<span class="rules">&#123;</span><br><span class="line">      <span class="rule"><span class="attribute">background</span>:<span class="value"> <span class="hexcolor">#c3d9ff</span></span></span>;</span><br><span class="line">    &#125;</span></span><br><span class="line">    50%<span class="rules">&#123;</span><br><span class="line">      <span class="rule"><span class="attribute">background</span>:<span class="value"> <span class="hexcolor">#bbaad7</span></span></span>;</span><br><span class="line">      <span class="rule"><span class="attribute">transform</span>:<span class="value"> <span class="function">translate3d</span>(<span class="number">200px</span>, <span class="number">200px</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">      <span class="rule"><span class="attribute">border-radius</span>:<span class="value"> <span class="number">50%</span></span></span>;</span><br><span class="line">    &#125;</span></span><br><span class="line">    75%<span class="rules">&#123;</span><br><span class="line">      <span class="rule"><span class="attribute">background</span>:<span class="value"> <span class="hexcolor">#c3d9ff</span></span></span>;</span><br><span class="line">    &#125;</span></span><br><span class="line">    100%<span class="rules">&#123;</span><br><span class="line">      <span class="rule"><span class="attribute">background</span>:<span class="value"> <span class="hexcolor">#32beec</span></span></span>;</span><br><span class="line">    &#125;</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>把属性值设置为alternate时，只需把中间状态设置成100%达到同样的效果<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="at_rule">@<span class="keyword">keyframes</span> move2</span>&#123;</span><br><span class="line">      0%<span class="rules">&#123;</span><br><span class="line">        <span class="rule"><span class="attribute">background</span>:<span class="value"> <span class="hexcolor">#32beec</span></span></span>;</span><br><span class="line">      &#125;</span></span><br><span class="line">      50%<span class="rules">&#123;</span><br><span class="line">        <span class="rule"><span class="attribute">background</span>:<span class="value"> <span class="hexcolor">#c3d9ff</span></span></span>;</span><br><span class="line">      &#125;</span></span><br><span class="line">      100%<span class="rules">&#123;</span><br><span class="line">        <span class="rule"><span class="attribute">background</span>:<span class="value"> <span class="hexcolor">#bbaad7</span></span></span>;</span><br><span class="line">        <span class="rule"><span class="attribute">transform</span>:<span class="value"> <span class="function">translate3d</span>(<span class="number">200px</span>, <span class="number">200px</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="rule"><span class="attribute">border-radius</span>:<span class="value"> <span class="number">50%</span></span></span>;</span><br><span class="line">      &#125;</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p><strong> (8) animation-play-state </strong></p>
<p>animation-play-state 属性规定动画正在运行还是暂停。</p>
<p><strong> (9) animation-fill-mode </strong></p>
<blockquote>
<p><strong> none</strong>：默认值。不设置对象动画之外的状态<br><br><strong> forwards</strong>：结束后保持动画结束时的状态，但当animation-direction为0，则动画不执行，持续保持动画开始时的状态<br><br><strong> backwards</strong>：结束后返回动画开始时的状态<br><br><strong> both</strong>：结束后可遵循forwards和backwards两个规则。<br>第一次上手动画的时候都遇到过“动画结束后，突然跳回第一帧！”的坑吧，设置animation-fill-mode为forwards就能保持最后一帧的状态了。</p>
<h2 id="CSS3_u9010_u5E27_u52A8_u753B"><a href="#CSS3_u9010_u5E27_u52A8_u753B" class="headerlink" title="CSS3逐帧动画"></a>CSS3逐帧动画</h2><p>实现帧动画，得用到上面讲的<strong> animation-time-function </strong>的steps，这个函数有二个参数，第一个可以理解成过渡需要的步数，如下面的例子step(1)，表示从0%-50%需要过渡1步。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.step&#123;&#10;  width:65px;&#10;  height:70px;&#10;  background:url(&#39;http://7xjj1h.com1.z0.glb.clouddn.com/%20dragin.png&#39;) no-repeat;&#10;  background-position:-188px 0;&#10;  animation:move steps(1) 0.4s  infinite;&#10;&#125;&#10;@keyframes move&#123;&#10;  0%&#123;&#10;    background-position:-188px 0;&#10;  &#125;&#10;  50%&#123;&#10;    background-position:-251px 0;&#10;  &#125;&#10;  100%&#123;&#10;    background-position:-317px 0;&#10;  &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p>step第二个参数用来设置最后一步的状态，start表示结束的状态，end表示开始的状态，w3c这张图，很精准地像我们描述了二者的差异。<br><img src="http://7xr52v.com1.z0.glb.clouddn.com/091121212334792.png" alt="w3c"><br>当为start的时候是看不到0%的状态的，而当为end的时候是看不到100%的状态的（没有持续的时间）。<br>基于这个原理我们可以把上面的例子再简化一下。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"> .step&#123;&#10;            width:65px;&#10;            height:70px;&#10;            background:url(&#39;http://7xjj1h.com1.z0.glb.clouddn.com/%20dragin.png&#39;) no-repeat -188px 0;&#10;            animation:move steps(3) 0.4s infinite;&#10;        &#125;&#10;@keyframes move&#123;&#10;            0%&#123;&#10;                background-position:-188px 0;&#10;            &#125;&#10;            100%&#123;&#10;                background-position:-380px 0;&#10;            &#125;&#10;        &#125;</span><br></pre></td></tr></table></figure>
<p></p><p data-height="265" data-theme-id="0" data-slug-hash="dOWmgE" data-default-tab="css,result" data-user="Expelliarmus923" data-embed-version="2" data-pen-title="CSS3帧动画" class="codepen">See the Pen <a href="https://codepen.io/Expelliarmus923/pen/dOWmgE/" target="_blank" rel="external">CSS3帧动画</a> by web前端嗨起来 (<a href="http://codepen.io/Expelliarmus923" target="_blank" rel="external">@Expelliarmus923</a>) on <a href="http://codepen.io" target="_blank" rel="external">CodePen</a>.</p><p></p>
<p><script async src="https://production-assets.codepen.io/assets/embed/ei.js"></script><br>因为steps，第一个参数从0%到100%要平均走三步，第二个默认参数是end，当位置为100%是不会显示的，在正确的雪碧图下，该动画就会正常显示了。<br>如果实在不知道要设置几帧安利一个动画<a href="http://tid.tenpay.com/labs/css3_keyframes_calculator.html" target="_blank" rel="external">帧数计算器</a></p>
<p>##CSS3序列动画<br>多个元素使用相同的动画效果时，将动画执行时机依次错开，可形成整齐有序的序列动画效果。<br>因为css3动画没有时间轴的概念，好在我们可以用animation-delay实现相同的效果。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.loop(@n:1) when(@n&#60;=4)&#123;&#10;  @v:@n*0.2;&#10;  &#38;:nth-child(@&#123;n&#125;)&#123;&#10;    animation-delay:~&#34;@&#123;v&#125;s&#34;;&#10;  &#125;&#10;  .loop(@n+1);&#10;&#125;</span><br></pre></td></tr></table></figure>
<p></p><p data-height="265" data-theme-id="0" data-slug-hash="vyevzo" data-default-tab="css,result" data-user="Expelliarmus923" data-embed-version="2" data-pen-title="CSS3序列动画" class="codepen">See the Pen <a href="https://codepen.io/Expelliarmus923/pen/vyevzo/" target="_blank" rel="external">CSS3序列动画</a> by web前端嗨起来 (<a href="http://codepen.io/Expelliarmus923" target="_blank" rel="external">@Expelliarmus923</a>) on <a href="http://codepen.io" target="_blank" rel="external">CodePen</a>.</p><p></p>
<p><script async src="https://production-assets.codepen.io/assets/embed/ei.js"></script></p>
<h2 id="u53C2_u8003"><a href="#u53C2_u8003" class="headerlink" title="参考"></a>参考</h2><p><a href="http://www.ruanyifeng.com/blog/2014/02/css_transition_and_animation.html" target="_blank" rel="external">css3动画简介</a><br><a href="http://isux.tencent.com/css3/index.html" target="_blank" rel="external">css3动画手册</a><br><a href="http://www.w3cmark.com/2015/422.html" target="_blank" rel="external">css3逐帧动画-飘动旗子</a><br><a href="https://segmentfault.com/a/1190000003760874?utm_source=tuicool&amp;utm_medium=referral" target="_blank" rel="external">css动画step</a><br><a href="http://www.cnblogs.com/aaronjs/p/4642015.html" target="_blank" rel="external">深入理解steps</a><br><a href="https://aotu.io/notes/2016/01/04/css3-animation/" target="_blank" rel="external">css3动画实战</a><br><a href="http://weibo.com/p/1001603865643593165786" target="_blank" rel="external">H5动画性能优化</a></p>
</div></article></div></section><footer><div class="paginator"><a href="/2016/03/25/JavaScript图片预加载/" class="next">下一篇</a></div><div class="copyright"><p>© 2015 - 2016 <a href="http://blog.lulizhou.com">lulizhou</a>, unless otherwise noted.</p></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src ="//hm.baidu.com/hm.js?a36e15d9e2adec9a21fcdd9f686b1ed2";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script src="https://cdn.bootcss.com/mathjax/2.5.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script src="http://7xowc1.com1.z0.glb.clouddn.com/tiny-progress.min.js"></script><script>new porgressbar({'height':'4px','background':'#42b983'});</script></body></html>